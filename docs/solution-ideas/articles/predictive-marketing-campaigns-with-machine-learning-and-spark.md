---
title: Predictive Marketing with Machine Learning
titleSuffix: Azure Solution Ideas
author: adamboeglin
ms.date: 12/16/2019
description: Learn how to build a machine-learning model with Microsoft R Server on Azure HDInsight Spark clusters to recommend actions to maximize the purchase rate.
ms.custom: acom-architecture, predictive marketing, ai-ml, analytics, predictive analytics software, predictive analytics marketing, 'https://azure.microsoft.com/solutions/architecture/predictive-marketing-campaigns-with-machine-learning-and-spark/'
---
# Predictive Marketing with Machine Learning

[!INCLUDE [header_file](../header.md)]

Marketing campaigns are about more than the message being delivered; when and how that message is delivered is just as important. Without a data-driven, analytical approach, campaigns can easily miss opportunities or struggle to gain traction.

Through machine learning informed by historical campaign data, this solution architecture helps predict customer responses and recommends an optimized plan for connecting with your leadsâ€”including the best channel to use (by email, SMS, a cold call, etc.), the best day of the week, and the best time of the day.

Optimizing your campaigns with predictive marketing helps improve both sales leads and revenue generation and can provide strong ROI for your marketing investment.

This architecture enables efficient handling of big data on Spark with Microsoft R Server.

## Architecture

<svg class="architecture-diagram" aria-labelledby="predictive-marketing-campaigns-with-machine-learning-and-spark" height="389.326" viewbox="0 0 920.306 389.326"  xmlns="http://www.w3.org/2000/svg">
    <text fill="#505050" font-family="SegoeUI, Segoe UI" font-size="14.805" style="isolation:isolate" transform="matrix(1.036 0 0 1 835.322 98.523)">
        Dashb<tspan letter-spacing="-.013em" x="41.279" y="0">o</tspan><tspan letter-spacing="0em" x="49.758" y="0">a</tspan><tspan letter-spacing="-.013em" x="57.292" y="0">r</tspan><tspan x="62.244" y="0">d</tspan>
    </text>
    <path d="M125 75.511L98.768 31.927l-.037-17.667h.469a5.563 5.563 0 005.651-5.469 5.562 5.562 0 00-5.671-5.444l-28.521.059a5.563 5.563 0 00-5.651 5.469 5.563 5.563 0 005.674 5.445h.472l.037 17.665L45.14 75.677c-2.858 4.792-.5 8.7 5.23 8.691l69.436-.145c5.733-.011 8.07-3.932 5.194-8.712z" fill="#59b4d9"/>
    <path fill="#b8d432" d="M66.631 56.849L55.882 74.878l58.371-.121-10.823-17.984-36.799.076z"/>
    <path d="M83.072 62.166a5.181 5.181 0 005.264-5.094 4.9 4.9 0 00-.542-2.223l-9.476.02a4.894 4.894 0 00-.533 2.225 5.183 5.183 0 005.287 5.072z" fill="#7fba00"/>
    <ellipse cx="92.986" cy="68.025" fill="#7fba00" rx="2.588" ry="2.494" transform="translate(-.141 .194)"/>
    <path d="M45.14 75.677l26.051-43.694-.037-17.665h-.472a5.563 5.563 0 01-5.674-5.445 5.561 5.561 0 015.651-5.467l12.29-.026.059 28.439-13.668 52.51-18.97.04c-5.734.011-8.088-3.9-5.23-8.692z" fill="#fff" opacity=".25" style="isolation:isolate"/>
    <text fill="#505050" font-family="SegoeUI, Segoe UI" font-size="17.174" transform="matrix(1.036 0 0 1 15.244 108.862)">
        Machine Learning
    </text>
    <text fill="#505050" font-family="SegoeUI, Segoe UI" font-size="17.174" transform="matrix(1.036 0 0 1 439.803 351.076)">
        HDInsight
    </text>
    <path fill="none" stroke="#afafaf" stroke-miterlimit="10" stroke-width="1.074" d="M478.962 130.236v78.784"/>
    <path fill="#afafaf" d="M473.606 131.803l5.356-9.276 5.357 9.276h-10.713zM473.606 207.453l5.356 9.277 5.357-9.277h-10.713z"/>
    <path fill="#fcd116" d="M462.422 263.302l-7.328 1.256-6.49 2.932-5.653 3.559-5.444 6.49-2.931 3.141-2.931 1.047-.838-1.885 1.466-1.884.209-2.722h1.047l.837.838-.209-2.722-1.047-.838v-1.046l-2.512 1.465-2.513 2.722-.419 2.513 1.047 2.093.838 3.35 1.884.838h2.094l1.884-1.257-1.256 6.491 1.256 7.118-1.465 3.35-4.397 4.816.628 3.141 2.303 3.349 3.978 2.722 2.303.419h2.303l-1.465 6.281 5.443 2.303 6.909.838 2.304-1.675.209-3.978 2.722-4.397.209-3.559 6.281.628 5.863-.628-5.863 3.559 1.047 4.187 3.559 5.863 3.769 1.465 2.722-1.047 1.256-2.512 6.072-4.606 1.256 1.047 9.422.418 1.884-1.675.209-2.721-.628-1.047-.418-7.328-3.141-6.281.419-2.932 1.884 1.047 5.444 5.025 2.512.21 2.931-1.257 2.932-2.093 1.465-4.816 8.375.628 5.234-2.093 4.188-3.769 2.931-5.653.837-6.7-.628-7.537-1.675-6.91-1.675-2.303-2.303-.628-3.978 4.397-3.559 1.256-3.141-5.234-3.14-2.931-1.885-1.047-6.699-5.862-5.653-2.932-5.444-.418-6.491 1.047-5.653 2.093-3.768 3.141-3.141 3.768-3.14.838-5.444 5.234z"/>
    <path fill="#1e1e1e" d="M434.157 277.539l.837 1.047.21-1.256h-.628l-.419.209z"/>
    <path d="M530.467 269.374a23.214 23.214 0 00-2.512-8.374c-.209-.209-.419-.628-.628-.837a8.646 8.646 0 00-2.3-1.466 3.106 3.106 0 00-2.722 0c-.209.209-.419.209-.628.419a11.613 11.613 0 00-1.256 1.675 14.762 14.762 0 01-1.466 1.884 8.125 8.125 0 01-2.3 1.256 8.125 8.125 0 00-1.256-2.3 19.642 19.642 0 00-1.884-2.512l-1.675-1.675-1.884-1.256a46.607 46.607 0 01-5.025-3.978c-.628-.628-1.466-1.256-2.094-1.884-3.769-3.141-7.328-4.606-11.1-4.816s-7.747.837-12.562 2.722a22.07 22.07 0 00-5.444 3.35 30.049 30.049 0 00-3.978 4.606 6.194 6.194 0 00-2.094.419 7.43 7.43 0 00-2.512 1.675 13.546 13.546 0 01-1.884 1.675l-1.675 1.675a45.868 45.868 0 00-10.887 2.722 31.367 31.367 0 00-9 5.444 15.741 15.741 0 00-3.141 3.35 34.1 34.1 0 00-2.3 3.559l-1.884 1.884a4.344 4.344 0 01-2.094 1.256 1.62 1.62 0 01-.628.209v-.209a5.369 5.369 0 001.256-3.978c.209.209.209.419.419.628s.209.419.419.628l.419-.419.628.209a8.78 8.78 0 00.209-3.35 2.877 2.877 0 00-1.047-1.675c0-.209.209-.209.209-.419a3.026 3.026 0 00.419-1.466l-.419-.209.419.209.628-.419-.837.209a13.6 13.6 0 00-5.653 3.559 9.3 9.3 0 00-1.675 2.3 4.672 4.672 0 00-.628 2.722 6.289 6.289 0 001.256 2.3 13.343 13.343 0 00.419 1.466 2.976 2.976 0 01.419 1.256 4.35 4.35 0 002.3 2.094 5.1 5.1 0 002.512 0c-.209 1.047-.209 2.094-.419 3.141a43.826 43.826 0 00.209 5.025 2.656 2.656 0 00.209 1.256c0 .419.209.837.209 1.256a2.976 2.976 0 00-.419 1.256 8.75 8.75 0 01-.837 2.094l-1.678 1.68-1.466 1.466-.419.419c-1.047 1.047-1.256 1.256-1.047 2.931a29.817 29.817 0 001.047 3.35 12.725 12.725 0 002.094 2.931 22.36 22.36 0 005.234 3.35 6.211 6.211 0 003.35.419c0 .209 0 .419-.209.419a10.208 10.208 0 00-.628 1.466c-1.256 2.931 0 4.4 2.094 5.234a20.58 20.58 0 003.35 1.047c.209 0 .419.209.837.209a31.291 31.291 0 005.862 1.256c2.3.209 4.4-.419 5.025-2.512a9.214 9.214 0 00.419-2.094V319.2a11.211 11.211 0 011.466-2.512c0-.209.209-.209.209-.419.419-.837.837-1.256.837-1.884v-2.512a25.338 25.338 0 003.978.209h2.094c-.209 0-.419.209-.628.209a.205.205 0 00-.209.209c-1.884.837-1.884 2.722-1.256 4.4a9.958 9.958 0 002.3 4.187c1.466 2.094 2.722 3.978 4.187 4.816 1.675 1.047 3.559 1.047 6.072-.209a4.35 4.35 0 002.094-2.3c.209-.209.419-.628.628-.837a31.334 31.334 0 013.141-2.512 8.864 8.864 0 011.466-1.047 6.97 6.97 0 001.256.628 7.851 7.851 0 002.3.209h5.444c1.466 0 2.722 0 3.559-.628 1.047-.628 1.466-1.466 1.675-3.141v-1.675a2.783 2.783 0 00-.628-1.466v-4.606a10.509 10.509 0 00-.419-2.512 10.205 10.205 0 00-.837-2.3c-.209-.628-.419-1.047-.628-1.675l-.419.209.419-.209a12.807 12.807 0 00-1.047-2.512v-.628l.837.837 1.256 1.256a14.416 14.416 0 002.722 2.3 5.053 5.053 0 003.559.837 8.3 8.3 0 004.606-1.675 10.233 10.233 0 002.931-3.769c.209-.419.209-.837.419-1.256 0-.419.209-.628.209-1.047a23.974 23.974 0 006.7.209 18.567 18.567 0 006.072-1.675 15.4 15.4 0 006.072-6.072 23.666 23.666 0 002.931-9.422c-.211-2.515-.411-6.282-1.044-9.841zm-31.406 25.334c-.628 2.094-1.675 5.653 1.256 6.281a3.729 3.729 0 003.141-.628 5.9 5.9 0 01-2.722 0 1.836 1.836 0 01-1.466-1.256c.209.209.628.209 1.466.419 2.094.419 4.187-.419 4.606-2.094a21.646 21.646 0 01.628-2.512 13.343 13.343 0 001.466.419c-.209.837-.628 1.675-.837 2.722a5.92 5.92 0 01-5.862 3.978c-2.3 0-3.559-1.466-5.234-2.722-1.047-.837-2.094-1.884-3.141-2.722a23.162 23.162 0 01-7.537-3.769c1.884 2.094 3.141 3.35 5.653 4.4-.419 3.769-1.675 6.49-2.722 10.05-.419 1.675-4.4 8.165-5.653 8.794-.837.419-5.653 4.606-6.7 5.234a9.4 9.4 0 01-2.3 2.722c-3.141 1.675-5.234-1.466-6.909-4.187-.837-1.256-2.931-4.816-1.047-5.862 1.675-.837 2.722-1.675 4.606-2.722a6.362 6.362 0 001.047 1.466c0-.628-.209-1.047-.209-1.675a5.976 5.976 0 010-2.722c0-.837.209-1.884.209-2.722-.209 1.047-.837 1.884-1.047 2.931a1.887 1.887 0 00-.209 1.047 33.829 33.829 0 01-12.143.209c-.209-1.466-.628-3.141-.837-4.187v6.7a4.766 4.766 0 01-.837 3.35c-.628 1.256-1.047 1.466-2.094 3.559a18.01 18.01 0 01-.209 3.35c-.628 2.094-6.281.419-7.747 0-1.884-.419-5.653-1.256-4.816-3.769a30.368 30.368 0 001.884-7.537c-3.35-4.816-6.49-11.515-7.119-17.587-.419-4.606-.209-7.537.837-10.259 1.675-4.4 3.769-8.375 7.328-11.515 4.816-4.187 9.212-5.862 16.331-6.909-1.675 1.884-3.35 3.978-5.234 6.072a32.443 32.443 0 00-4.187 6.7c-1.675 3.35-1.675 4.606.628 7.328 1.884 2.512 2.931 3.559 3.559 6.072a13.56 13.56 0 00-1.047 4.4c2.3 2.512 3.978 4.187 6.072 4.606a8.109 8.109 0 005.862-.628c4.187-2.094 8.165-5.025 12.981-5.234 2.3-5.444 2.094-10.05.837-15.493a92.73 92.73 0 01-1.256-10.678 27.293 27.293 0 00-.419 10.887c.837 4.606 1.466 9.631-.837 13.609-4.4.419-8.165 2.931-12.143 5.025a6.914 6.914 0 01-5.025.419c-1.256-.209-2.3-1.256-4.187-3.35a9.726 9.726 0 011.256-4.816 91.3 91.3 0 015.018-8.594c-2.094 2.722-4.187 5.025-5.862 7.537-.628-1.884-1.675-2.931-3.141-5.025s-1.675-2.931-.628-5.444c1.256-2.512 2.094-4.606 4.187-6.7 3.35-3.769 6.49-7.747 10.259-11.515 2.094-1.884 2.931-1.884 5.444-2.3s4.816-.837 7.328-1.466a42.741 42.741 0 01-7.119.628c2.3-2.931 3.559-4.606 7.328-6.281 9.212-3.978 15.075-4.4 22.193 1.675a50.126 50.126 0 005.444 4.4 9.214 9.214 0 00-2.094.419 7.982 7.982 0 013.141.209c.209.209.628.419.837.628a8.524 8.524 0 012.931 2.512 27.723 27.723 0 012.512 4.187c-.419-.209-.837-.209-1.256-.419a1.259 1.259 0 00-.837-.209 2.518 2.518 0 00-1.675.419 6.822 6.822 0 01-2.722.837 2.312 2.312 0 001.675 0h.209c-.209.209-.209.628-.419 1.047a3.563 3.563 0 00.209 1.466c0 .209.209.209.209.419-.419.209-.628.209-1.047.419a20.178 20.178 0 015.025 0c.209.628.209 1.047.419 1.675h-.628a2.864 2.864 0 00-2.931-.209c-3.559.837-2.722 2.931-4.4 6.072 1.675-2.094 1.675-4.4 4.4-5.025.628-.209 1.047-.419 1.466-.209a4.108 4.108 0 00-1.884 1.884c-.837 2.3-.209 3.978-1.256 6.072 1.047-1.884 1.047-3.559 2.094-5.653.419-.628 1.675-1.884 2.3-1.884h.628a20.383 20.383 0 01.209 3.35c-.209 1.884-.628 4.606-.837 5.653 1.047-1.256 1.466-3.769 1.884-5.653a15.85 15.85 0 000-6.281c-.628-2.931 2.3-2.3 3.978-3.769 1.256-1.047 2.094-2.512 3.141-3.559s2.931.419 3.35 1.675a41.679 41.679 0 012.3 16.75c-.628 5.234-3.141 11.1-7.747 13.609-5.862 3.35-12.981 1.256-18.843-.628a14.956 14.956 0 01-3.141-1.675 4.7 4.7 0 01.429 3.762zm-5.234 21.146c-.209 2.094-.837 2.3-2.931 2.3a43.763 43.763 0 01-5.234-.209 11.374 11.374 0 01-2.3-.419c1.884-1.466 5.234-7.328 5.862-9.422s1.466-3.978 1.884-6.072a11.8 11.8 0 00.837 2.512 12.391 12.391 0 011.047 3.978 40.343 40.343 0 00.209 5.025 3.24 3.24 0 01.627 2.307zm-61.136-43.549a3.341 3.341 0 00-.628 1.675c-.628 2.3.209 4.4-1.884 6.072 1.047 1.884.837 2.722 3.141 1.884a8.646 8.646 0 002.3-1.466c-.209.837-.628 1.675-.837 2.512 0 .209 0 .209-.209.419-1.675.628-3.769 1.047-4.606-.628a10.365 10.365 0 01-.837-2.722c-2.721-2.721 1.257-6.49 3.56-7.746zm.209 2.512a1.259 1.259 0 01.209-.837c0-.209 0-.209.209-.419.628.419.628.837.837 1.675-.417-.418-.836-.628-1.255-.418zm2.094 24.5a49.484 49.484 0 005.653 12.143 14.426 14.426 0 01-.628 1.675c-1.675 2.3-5.862-1.047-7.119-2.3a8.469 8.469 0 01-2.512-4.606c-.209-1.047 0-1.047.837-1.884l3.141-3.141zm79.77-34.546c0 .209.209.419.209.628l-.209.209c-.209-.209-.419-.628-.628-.837zm-77.886 12.772zm-3.35-5.025zm-5.234 7.956zm29.312 30.777zm51.086-15.493zm18.843-7.119z" fill="#1e1e1e"/>
    <path d="M520 267.28c2.931-1.047 4.4-3.35 5.025-6.281a11.453 11.453 0 01-5.444 5.444c-1.256.628-2.094.419-3.559.209 1.464.628 2.511 1.048 3.978.628zM503.249 270.211a21.774 21.774 0 00-3.141.419c0-.419-.209-.628-.209-1.047a2.972 2.972 0 00-1.884-1.675c.628-.419 1.466-.837 2.094-1.256-1.675.837-3.559.628-5.025 1.466-1.256.837-2.931 3.559-4.187 4.606a17.465 17.465 0 002.512-1.675 3.882 3.882 0 00.419 1.466 3.3 3.3 0 001.466 1.466 6.549 6.549 0 00-1.047 2.094 18.293 18.293 0 019.002-5.864zM488.175 267.071c.628-2.512 1.466-4.816 5.234-6.49-5.025 1.256-5.863 3.349-5.234 6.49zM496.34 290.939c-.209.628-.209 1.675-.419 2.3a9.062 9.062 0 011.047-2.512c.419-.837.628-.837 1.466-1.256a19.455 19.455 0 002.094-1.047c-.628 0-1.675.419-2.3.419-1.469.212-1.679.631-1.888 2.096zM469.541 262.674c-1.884 1.884-3.559 7.956-4.187 10.469.837-2.094 3.141-7.747 4.816-9.212a4.38 4.38 0 011.256-.837c-1.256 2.094-1.047 2.512-.628 5.234.419-2.722 1.256-3.978 2.931-6.072 1.675-.419 3.35-1.047 5.234-1.675-2.094.209-3.978.419-6.072.628-1.885.418-2.304.418-3.35 1.465z" fill="#1e1e1e"/>
    <path d="M494.456 273.352a1.4 1.4 0 012.512-1.256v.209a13.546 13.546 0 00-1.884 1.675.669.669 0 01-.628-.628M509.949 267.28a1.047 1.047 0 112.094 0v.419a4.928 4.928 0 00-1.675.419c-.209 0-.419-.419-.419-.837" fill="#fffacb"/>
    <text fill="#505050" font-family="SegoeUI, Segoe UI" font-size="17.174" transform="matrix(1.036 0 0 1 428.383 109.56)">
        Blob Storage
    </text>
    <g>
        <path d="M433.4 74.35a3.426 3.426 0 003.28 3.462h84.373a3.46 3.46 0 003.462-3.462V14.032H433.4z" fill="#a0a1a2"/>
        <path d="M521.058 0h-84.373a3.426 3.426 0 00-3.28 3.462V13.85h91.115V3.462A3.46 3.46 0 00521.058 0" fill="#7a7a7a"/>
        <path fill="#0072c6" d="M440.147 20.228h37.175v23.69h-37.175zM440.147 47.198h37.175v23.69h-37.175z"/>
        <path fill="#fff" d="M480.602 20.228h36.993v23.69h-36.993z"/>
        <path fill="#0072c6" d="M480.602 47.198h36.993v23.69h-36.993z"/>
        <path d="M437.049 0a3.655 3.655 0 00-3.649 3.645v70.341a3.655 3.655 0 003.645 3.645h4.009L512.857 0z" fill="#fff" opacity=".2" style="isolation:isolate"/>
    </g>
    <g>
        <path fill="none" stroke="#afafaf" stroke-miterlimit="10" stroke-width="1.074" d="M595.128 38.907h176.167"/>
        <path fill="#afafaf" d="M596.696 44.263l-9.277-5.356 9.277-5.357v10.713zM769.728 44.263l9.276-5.356-9.276-5.357v10.713z"/>
    </g>
    <g>
        <path fill="none" stroke="#afafaf" stroke-miterlimit="10" stroke-width="1.074" d="M188.276 38.907h176.167"/>
        <path fill="#afafaf" d="M189.843 44.263l-9.276-5.356 9.276-5.357v10.713zM362.875 44.263l9.277-5.356-9.277-5.357v10.713z"/>
    </g>
    <path d="M909.019 67.339h-1.93v-3.86h1.93a7.436 7.436 0 007.427-7.427V16.627a7.436 7.436 0 00-7.427-7.427H835.9a7.436 7.436 0 00-7.427 7.428v39.427a7.436 7.436 0 007.427 7.427h1.93v3.86h-1.93a11.3 11.3 0 01-11.286-11.287V16.627A11.3 11.3 0 01835.9 5.34h73.121a11.3 11.3 0 0111.287 11.287v39.428a11.3 11.3 0 01-11.287 11.287"/>
    <path d="M847.751 54.417a5.237 5.237 0 015.237 5.237v12.077a5.238 5.238 0 01-5.238 5.238 5.237 5.237 0 01-5.239-5.235V59.655a5.238 5.238 0 015.238-5.238zM864.224 76.97a5.239 5.239 0 01-5.239-5.238v-31a5.238 5.238 0 0110.477 0v31a5.239 5.239 0 01-5.238 5.239M897.168 76.817a5.239 5.239 0 01-5.239-5.238v-43.9a5.238 5.238 0 1110.477 0v43.9a5.239 5.239 0 01-5.238 5.239M880.7 76.97a5.239 5.239 0 01-5.239-5.238V48.7a5.238 5.238 0 0110.477 0v23.032a5.239 5.239 0 01-5.238 5.239"/>
</svg>

## Components
* Microsoft R Server on [HDInsight](https://azure.microsoft.com/services/hdinsight/) Spark clusters provides distributed and scalable machine learning capabilities for big data, combining the power of R Server and Apache Spark.
* [Power BI](https://powerbi.microsoft.com) provides an interactive dashboard with visualization that uses data stored in SQL Server to drive decisions on the predictions.
* [Storage Accounts](https://azure.microsoft.com/services/storage/): Azure Storage stores campaign and lead data.
* [Machine Learning Studio](https://azure.microsoft.com/services/machine-learning-studio/): Machine Learning helps you easily design, test, operationalize, and manage predictive analytics solutions in the cloud.

## Next Steps
* [Learn more about Spark on HDInsight](/azure/hdinsight/hdinsight-apache-spark-overview)
* [Learn more about Power BI](https://powerbi.microsoft.com/documentation/powerbi-landing-page/)
* [Learn more about Azure storage](/azure/storage/storage-introduction)
* [Learn more about Machine Learning](/azure/machine-learning/machine-learning-what-is-machine-learning)

[!INCLUDE [js_include_file](../../_js/index.md)]
