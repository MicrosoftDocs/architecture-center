---
title: Campaign Optimization with SQL Server
titleSuffix: Azure Solution Ideas
author: adamboeglin
ms.date: 12/16/2019
description: This solution demonstrates how to build and deploy a machine learning model with SQL Server 2016 with R Services to recommend actions to maximize the purchase rate of leads targeted by a campaign.
ms.custom: acom-architecture, artificial intelligence, sql-server, solution architectures, Azure, ai gallery, 'https://azure.microsoft.com/solutions/architecture/campaign-optimization-with-sql-server/'
---
# Campaign Optimization with SQL Server

[!INCLUDE [header_file](../header.md)]

This solution demonstrates how to build and deploy a machine learning model with SQL Server 2016 with R Services to recommend actions to maximize the purchase rate of leads targeted by a campaign.

## Architecture

<svg class="architecture-diagram" aria-labelledby="campaign-optimization-with-sql-server" height="71.779" viewbox="0 0 811.074 71.779"  xmlns="http://www.w3.org/2000/svg">
    <path fill="#969696" d="M124.922 22.731h238.266v1.5H124.922z"/>
    <path fill="#969696" d="M361.655 18.246l9.067 5.235-9.067 5.236V18.246zM459.922 22.731h239.266v1.5H459.922z"/>
    <path fill="#969696" d="M697.655 18.246l9.067 5.235-9.067 5.236V18.246z"/>
    <path d="M382.074 67.9H380.8l-1.039-2.748h-4.156l-.975 2.748h-1.278l3.76-9.8h1.188zm-2.687-3.78l-1.538-4.177a4 4 0 01-.15-.656h-.027a3.733 3.733 0 01-.157.656l-1.524 4.177zM388.247 61.224l-4.147 5.722h4.1v.954h-5.749v-.349l4.149-5.691h-3.753v-.96h5.4zM395.356 67.9h-1.121v-1.1h-.027a2.3 2.3 0 01-2.16 1.271q-2.5 0-2.5-2.98V60.9h1.114v4.006q0 2.215 1.7 2.215a1.719 1.719 0 001.351-.6 2.321 2.321 0 00.529-1.583V60.9h1.121zM401.27 62.037a1.372 1.372 0 00-.848-.226 1.433 1.433 0 00-1.2.677 3.136 3.136 0 00-.481 1.846V67.9h-1.121v-7h1.121v1.442h.027a2.447 2.447 0 01.731-1.152 1.67 1.67 0 011.1-.413 1.837 1.837 0 01.67.1zM407.928 64.683h-4.942a2.614 2.614 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.954 2.954 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.832 3.832 0 01.926-2.663 2.973 2.973 0 012.3-1.028 2.63 2.63 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.286 2.286 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.809 1.809 0 00-1.347.567 2.574 2.574 0 00-.683 1.484zM413.608 67.9v-9.8h2.707q5.181 0 5.182 4.778a4.811 4.811 0 01-1.439 3.646 5.334 5.334 0 01-3.852 1.378zm1.148-8.764v7.725h1.463a4.155 4.155 0 003-1.032 3.868 3.868 0 001.073-2.926q0-3.768-4.006-3.767zM422.967 67.506v-1.353a2.633 2.633 0 00.558.369 4.349 4.349 0 00.684.276 5.231 5.231 0 00.721.175 4.018 4.018 0 00.67.062 2.624 2.624 0 001.582-.393 1.476 1.476 0 00.35-1.822 2 2 0 00-.482-.537 4.815 4.815 0 00-.729-.465c-.279-.147-.582-.3-.905-.468q-.513-.259-.957-.526a4.13 4.13 0 01-.772-.588 2.451 2.451 0 01-.516-.729 2.479 2.479 0 01.105-2.119 2.519 2.519 0 01.772-.816 3.5 3.5 0 011.091-.479 4.955 4.955 0 011.247-.157 4.783 4.783 0 012.112.349v1.292a3.829 3.829 0 00-2.229-.6 3.636 3.636 0 00-.752.079 2.084 2.084 0 00-.67.256 1.491 1.491 0 00-.479.458 1.216 1.216 0 00-.185.684 1.413 1.413 0 00.14.649 1.6 1.6 0 00.414.5 4.121 4.121 0 00.666.438q.394.212.906.465t1 .547a4.573 4.573 0 01.827.636 2.815 2.815 0 01.563.772 2.163 2.163 0 01.209.971 2.472 2.472 0 01-.283 1.228 2.341 2.341 0 01-.766.816 3.379 3.379 0 01-1.111.455 6.129 6.129 0 01-1.326.14 5.326 5.326 0 01-.574-.038q-.343-.037-.7-.109a5.43 5.43 0 01-.674-.178 2.09 2.09 0 01-.507-.24zM438.149 58.1l-3.63 9.8h-1.265l-3.554-9.8h1.278l2.714 7.772a4.68 4.68 0 01.2.868h.027a4.217 4.217 0 01.226-.882l2.769-7.759zM449.552 67.9h-1.142v-6.574q0-.779.1-1.907h-.027a6.194 6.194 0 01-.294.95l-3.35 7.533h-.561l-3.343-7.479a5.8 5.8 0 01-.294-1h-.027q.054.589.055 1.921V67.9h-1.107v-9.8h1.518l3.008 6.836a8.77 8.77 0 01.451 1.176h.041c.2-.538.354-.938.472-1.2l3.069-6.809h1.436zM572.794 13.506v-1.353a2.625 2.625 0 00.557.369 4.466 4.466 0 00.684.276 5.349 5.349 0 00.722.175 4.018 4.018 0 00.67.062 2.631 2.631 0 001.583-.393 1.333 1.333 0 00.522-1.132 1.317 1.317 0 00-.175-.69 1.961 1.961 0 00-.481-.537 4.9 4.9 0 00-.728-.465q-.422-.221-.906-.468-.513-.259-.957-.526a4.1 4.1 0 01-.772-.588 2.472 2.472 0 01-.513-.729 2.252 2.252 0 01-.187-.953 2.241 2.241 0 01.294-1.166 2.529 2.529 0 01.772-.816 3.5 3.5 0 011.09-.479 4.968 4.968 0 011.248-.157 4.783 4.783 0 012.112.349v1.291a3.826 3.826 0 00-2.229-.6 3.643 3.643 0 00-.752.079 2.093 2.093 0 00-.67.256 1.491 1.491 0 00-.479.458 1.216 1.216 0 00-.185.684 1.4 1.4 0 00.141.649 1.584 1.584 0 00.413.5 4.132 4.132 0 00.667.438q.393.212.905.465t1 .547a4.573 4.573 0 01.827.636 2.859 2.859 0 01.564.772 2.176 2.176 0 01.208.971 2.462 2.462 0 01-.284 1.228 2.315 2.315 0 01-.766.816 3.357 3.357 0 01-1.11.455 6.122 6.122 0 01-1.326.14 5.326 5.326 0 01-.574-.038q-.341-.037-.7-.109a5.325 5.325 0 01-.673-.178 2.048 2.048 0 01-.512-.239zM585.311 13.581a3.637 3.637 0 01-1.914.485 3.174 3.174 0 01-2.417-.974 3.536 3.536 0 01-.919-2.526 3.877 3.877 0 01.991-2.778 3.465 3.465 0 012.646-1.05 3.688 3.688 0 011.627.342v1.149a2.852 2.852 0 00-1.668-.547 2.259 2.259 0 00-1.761.769 2.926 2.926 0 00-.687 2.021 2.782 2.782 0 00.646 1.941 2.23 2.23 0 001.733.711 2.807 2.807 0 001.723-.608zM589.932 14.067a3.245 3.245 0 01-2.478-.981 3.629 3.629 0 01-.927-2.6 3.784 3.784 0 01.964-2.755 3.468 3.468 0 012.6-.991 3.141 3.141 0 012.444.964 3.824 3.824 0 01.878 2.673 3.761 3.761 0 01-.946 2.683 3.318 3.318 0 01-2.535 1.007zm.082-6.385a2.132 2.132 0 00-1.709.735 3.017 3.017 0 00-.629 2.026 2.855 2.855 0 00.636 1.962 2.161 2.161 0 001.7.718 2.049 2.049 0 001.671-.7 3.048 3.048 0 00.585-2 3.1 3.1 0 00-.585-2.023 2.039 2.039 0 00-1.669-.718zM598.859 8.037a1.372 1.372 0 00-.848-.226 1.433 1.433 0 00-1.2.677 3.136 3.136 0 00-.481 1.846V13.9h-1.121v-7h1.121v1.445h.027a2.447 2.447 0 01.731-1.152 1.67 1.67 0 011.1-.413 1.837 1.837 0 01.67.1zM605.518 10.683h-4.942a2.614 2.614 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.954 2.954 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.832 3.832 0 01.926-2.663 2.973 2.973 0 012.3-1.028 2.63 2.63 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.286 2.286 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.809 1.809 0 00-1.347.567 2.574 2.574 0 00-.684 1.483zM152.753 13.9V4.1h2.707q5.181 0 5.182 4.778a4.812 4.812 0 01-1.439 3.646 5.336 5.336 0 01-3.852 1.378zm1.147-8.761v7.725h1.463a4.155 4.155 0 003-1.032 3.87 3.87 0 001.073-2.926q0-3.768-4.006-3.767zM168.045 10.683H163.1a2.616 2.616 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.955 2.955 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.83 3.83 0 01.926-2.663 2.971 2.971 0 012.3-1.028 2.631 2.631 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.281 2.281 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.808 1.808 0 00-1.347.567 2.577 2.577 0 00-.684 1.483zM175.243 6.9l-2.789 7h-1.1l-2.652-7h1.23l1.777 5.086a4.618 4.618 0 01.246.978h.027a4.576 4.576 0 01.219-.95l1.86-5.114zM181.99 10.683h-4.942a2.616 2.616 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.955 2.955 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.83 3.83 0 01.926-2.663 2.971 2.971 0 012.3-1.028 2.631 2.631 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.281 2.281 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.808 1.808 0 00-1.347.567 2.577 2.577 0 00-.684 1.483zM184.807 13.9h-1.121V3.539h1.121zM190 14.067a3.246 3.246 0 01-2.478-.981 3.631 3.631 0 01-.926-2.6 3.784 3.784 0 01.964-2.755 3.468 3.468 0 012.6-.991 3.14 3.14 0 012.444.964 3.822 3.822 0 01.878 2.673 3.759 3.759 0 01-.947 2.683A3.316 3.316 0 01190 14.067zm.082-6.385a2.131 2.131 0 00-1.709.735 3.015 3.015 0 00-.629 2.026 2.855 2.855 0 00.636 1.962 2.161 2.161 0 001.7.718 2.051 2.051 0 001.671-.7 3.054 3.054 0 00.584-2 3.107 3.107 0 00-.584-2.023 2.041 2.041 0 00-1.667-.718zM196.428 12.891h-.028v4.231h-1.121V6.9h1.121v1.23h.027a2.651 2.651 0 012.42-1.395 2.563 2.563 0 012.112.94 3.89 3.89 0 01.759 2.519 4.344 4.344 0 01-.854 2.813 2.848 2.848 0 01-2.338 1.056 2.341 2.341 0 01-2.098-1.172zm-.027-2.823v.978a2.084 2.084 0 00.564 1.474 2.012 2.012 0 003.028-.175 3.573 3.573 0 00.578-2.167 2.822 2.822 0 00-.54-1.832 1.789 1.789 0 00-1.463-.663 1.984 1.984 0 00-1.568.68 2.5 2.5 0 00-.6 1.705zM212.355 13.9h-1.121v-1.091h-.027a2.347 2.347 0 01-2.153 1.258 2.3 2.3 0 01-1.637-.554 1.919 1.919 0 01-.591-1.47q0-1.961 2.311-2.283l2.1-.294q0-1.784-1.442-1.784a3.445 3.445 0 00-2.283.861V7.395a4.337 4.337 0 012.379-.656q2.468 0 2.468 2.611zm-1.121-3.541l-1.688.232a2.759 2.759 0 00-1.176.386 1.115 1.115 0 00-.4.981 1.067 1.067 0 00.366.837 1.411 1.411 0 00.974.325 1.8 1.8 0 001.377-.585 2.086 2.086 0 00.543-1.479zM220.278 13.9h-1.121V9.91q0-2.228-1.627-2.229a1.766 1.766 0 00-1.391.632 2.346 2.346 0 00-.55 1.6V13.9h-1.121v-7h1.121v1.165h.027a2.526 2.526 0 012.3-1.326 2.142 2.142 0 011.757.741 3.308 3.308 0 01.608 2.144zM228.365 13.9h-1.121v-1.187h-.027a2.824 2.824 0 01-4.515.413 3.853 3.853 0 01-.79-2.56 4.2 4.2 0 01.875-2.782 2.885 2.885 0 012.331-1.046 2.243 2.243 0 012.1 1.135h.027V3.539h1.121zm-1.121-3.165v-1.03a2 2 0 00-.561-1.436 1.882 1.882 0 00-1.422-.588 1.936 1.936 0 00-1.613.752 3.294 3.294 0 00-.588 2.078 2.966 2.966 0 00.564 1.911 1.843 1.843 0 001.514.7 1.915 1.915 0 001.521-.677 2.522 2.522 0 00.585-1.707zM234.62 13.9V4.1h2.707q5.181 0 5.182 4.778a4.812 4.812 0 01-1.439 3.646 5.336 5.336 0 01-3.852 1.378zm1.148-8.764v7.725h1.463a4.155 4.155 0 003-1.032 3.87 3.87 0 001.073-2.926q0-3.768-4.006-3.767zM249.912 10.683h-4.942a2.616 2.616 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.955 2.955 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.83 3.83 0 01.926-2.663 2.971 2.971 0 012.3-1.028 2.631 2.631 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.281 2.281 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.808 1.808 0 00-1.347.567 2.577 2.577 0 00-.684 1.483zM252.756 12.891h-.027v4.231h-1.121V6.9h1.121v1.23h.027a2.651 2.651 0 012.42-1.395 2.563 2.563 0 012.112.94 3.89 3.89 0 01.759 2.519 4.344 4.344 0 01-.854 2.813 2.848 2.848 0 01-2.338 1.056 2.341 2.341 0 01-2.099-1.172zm-.027-2.823v.978a2.084 2.084 0 00.564 1.474 2.012 2.012 0 003.028-.175 3.573 3.573 0 00.578-2.167 2.822 2.822 0 00-.54-1.832 1.789 1.789 0 00-1.463-.663 1.984 1.984 0 00-1.572.681 2.5 2.5 0 00-.595 1.704zM260.959 13.9h-1.121V3.539h1.121zM266.154 14.067a3.246 3.246 0 01-2.478-.981 3.631 3.631 0 01-.926-2.6 3.784 3.784 0 01.964-2.755 3.468 3.468 0 012.6-.991 3.14 3.14 0 012.444.964 3.822 3.822 0 01.878 2.673 3.759 3.759 0 01-.947 2.683 3.316 3.316 0 01-2.535 1.007zm.082-6.385a2.131 2.131 0 00-1.709.735 3.015 3.015 0 00-.629 2.026 2.855 2.855 0 00.636 1.962 2.161 2.161 0 001.7.718 2.051 2.051 0 001.671-.7 3.054 3.054 0 00.584-2 3.107 3.107 0 00-.584-2.023 2.041 2.041 0 00-1.669-.718zM277 6.9l-3.22 8.121q-.861 2.174-2.42 2.174a2.586 2.586 0 01-.731-.089v-1a2.076 2.076 0 00.663.123 1.374 1.374 0 001.271-1.012l.561-1.326-2.731-6.991h1.244l1.894 5.387q.034.1.144.533h.041q.034-.164.137-.52l1.989-5.4zM292.186 13.9h-1.142V7.326q0-.779.1-1.907h-.027a6.085 6.085 0 01-.294.95l-3.35 7.533h-.561l-3.343-7.479a5.889 5.889 0 01-.294-1h-.027q.054.589.055 1.921V13.9h-1.107V4.1h1.518l3.008 6.836a8.77 8.77 0 01.451 1.176h.041c.2-.538.353-.938.472-1.2L290.75 4.1h1.436zM297.538 14.067a3.247 3.247 0 01-2.479-.981 3.632 3.632 0 01-.926-2.6 3.784 3.784 0 01.967-2.756 3.468 3.468 0 012.6-.991 3.138 3.138 0 012.443.964 3.82 3.82 0 01.879 2.673 3.757 3.757 0 01-.947 2.683 3.314 3.314 0 01-2.537 1.008zm.082-6.385a2.13 2.13 0 00-1.709.735 3.012 3.012 0 00-.629 2.026 2.855 2.855 0 00.636 1.962 2.161 2.161 0 001.7.718 2.054 2.054 0 001.672-.7 3.059 3.059 0 00.584-2 3.113 3.113 0 00-.584-2.023 2.044 2.044 0 00-1.67-.718zM308.79 13.9h-1.121v-1.187h-.027a2.589 2.589 0 01-2.406 1.354 2.616 2.616 0 01-2.109-.94 3.859 3.859 0 01-.789-2.56 4.192 4.192 0 01.875-2.782 2.885 2.885 0 012.331-1.046 2.243 2.243 0 012.1 1.135h.027V3.539h1.121zm-1.121-3.165v-1.03a2 2 0 00-.561-1.436 1.882 1.882 0 00-1.422-.588 1.936 1.936 0 00-1.613.752 3.291 3.291 0 00-.588 2.078 2.961 2.961 0 00.564 1.911 1.841 1.841 0 001.514.7 1.918 1.918 0 001.521-.677 2.527 2.527 0 00.585-1.707zM316.686 10.683h-4.942a2.614 2.614 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.954 2.954 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.832 3.832 0 01.926-2.663 2.973 2.973 0 012.3-1.028 2.63 2.63 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.286 2.286 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.809 1.809 0 00-1.347.567 2.574 2.574 0 00-.684 1.483zM319.5 13.9h-1.121V3.539h1.121zM321.348 13.65v-1.2a3.316 3.316 0 002.017.677q1.477 0 1.477-.984a.854.854 0 00-.127-.476 1.258 1.258 0 00-.342-.345 2.584 2.584 0 00-.506-.271c-.193-.079-.4-.162-.625-.249a8.022 8.022 0 01-.816-.372 2.48 2.48 0 01-.588-.424 1.559 1.559 0 01-.355-.537 1.9 1.9 0 01-.12-.7 1.677 1.677 0 01.226-.872 1.994 1.994 0 01.6-.635 2.768 2.768 0 01.857-.387 3.842 3.842 0 011-.13 4.01 4.01 0 011.627.314v1.129a3.173 3.173 0 00-1.777-.506 2.112 2.112 0 00-.567.071 1.391 1.391 0 00-.434.2.936.936 0 00-.281.312.823.823 0 00-.1.4.966.966 0 00.1.458 1.01 1.01 0 00.291.328 2.225 2.225 0 00.465.26c.182.078.39.162.622.253a8.453 8.453 0 01.834.366 2.808 2.808 0 01.629.424 1.638 1.638 0 01.4.543 1.749 1.749 0 01.141.731 1.726 1.726 0 01-.229.9 1.971 1.971 0 01-.612.636 2.821 2.821 0 01-.882.376 4.358 4.358 0 01-1.046.123 3.979 3.979 0 01-1.879-.413zM710.251 58.1l-3.63 9.8h-1.265l-3.556-9.8h1.278l2.714 7.772a4.68 4.68 0 01.2.868h.027a4.217 4.217 0 01.226-.882l2.769-7.759zM712.083 59.125a.71.71 0 01-.513-.205.69.69 0 01-.212-.52.719.719 0 01.725-.731.724.724 0 01.523.209.731.731 0 010 1.035.723.723 0 01-.523.212zm.547 8.777h-1.121v-7h1.121zM714.476 67.65v-1.2a3.318 3.318 0 002.017.677q1.477 0 1.477-.984a.861.861 0 00-.126-.476 1.3 1.3 0 00-.342-.345 2.671 2.671 0 00-.506-.271 34.39 34.39 0 00-.626-.249 8.246 8.246 0 01-.817-.372 2.541 2.541 0 01-.588-.424 1.6 1.6 0 01-.355-.537 1.916 1.916 0 01-.119-.7 1.677 1.677 0 01.226-.872 1.994 1.994 0 01.6-.635 2.764 2.764 0 01.858-.387 3.824 3.824 0 01.994-.13 4.013 4.013 0 011.627.314v1.135a3.175 3.175 0 00-1.777-.506 2.117 2.117 0 00-.567.071 1.407 1.407 0 00-.435.2.93.93 0 00-.279.312.813.813 0 00-.1.4.954.954 0 00.1.458 1 1 0 00.29.328 2.25 2.25 0 00.465.26q.274.117.622.253a8.453 8.453 0 01.834.366 2.831 2.831 0 01.629.424 1.655 1.655 0 01.4.543 1.764 1.764 0 01.14.731 1.717 1.717 0 01-.229.9 1.958 1.958 0 01-.611.636 2.821 2.821 0 01-.882.376 4.358 4.358 0 01-1.046.123 3.977 3.977 0 01-1.874-.419zM726.5 67.9h-1.121v-1.1h-.027a2.3 2.3 0 01-2.16 1.271q-2.5 0-2.5-2.98V60.9h1.108v4.006q0 2.215 1.7 2.215a1.716 1.716 0 001.35-.6 2.317 2.317 0 00.53-1.583V60.9h1.12zM733.773 67.9h-1.121v-1.091h-.027a2.347 2.347 0 01-2.153 1.258 2.3 2.3 0 01-1.637-.554 1.918 1.918 0 01-.592-1.47q0-1.961 2.311-2.283l2.1-.294q0-1.784-1.442-1.784a3.444 3.444 0 00-2.283.861v-1.148a4.335 4.335 0 012.379-.656q2.467 0 2.468 2.611zm-1.121-3.541l-1.688.232a2.756 2.756 0 00-1.176.386 1.115 1.115 0 00-.4.981 1.068 1.068 0 00.365.837 1.413 1.413 0 00.975.325 1.794 1.794 0 001.377-.585 2.082 2.082 0 00.544-1.479zM737.007 67.9h-1.121V57.539h1.121zM739.851 59.125a.71.71 0 01-.513-.205.69.69 0 01-.212-.52.719.719 0 01.725-.731.724.724 0 01.523.209.731.731 0 010 1.035.723.723 0 01-.523.212zm.549 8.775h-1.121v-7h1.121zM747.548 61.224l-4.143 5.722h4.1v.954h-5.749v-.349l4.144-5.691h-3.753v-.96h5.4zM754.623 64.683h-4.942a2.614 2.614 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.954 2.954 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.832 3.832 0 01.926-2.663 2.973 2.973 0 012.3-1.028 2.63 2.63 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.286 2.286 0 00-.468-1.511 1.6 1.6 0 00-1.282-.54 1.809 1.809 0 00-1.347.567 2.574 2.574 0 00-.684 1.483zM761.452 64.2v3.7H760.3v-9.8h2.7a3.556 3.556 0 012.438.766 2.735 2.735 0 01.864 2.16 2.973 2.973 0 01-.96 2.283 3.671 3.671 0 01-2.595.889zm0-5.059v4.02h1.2a2.682 2.682 0 001.814-.544 1.918 1.918 0 00.626-1.534q0-1.941-2.3-1.941zM770.4 68.067a3.245 3.245 0 01-2.478-.981 3.629 3.629 0 01-.927-2.6 3.784 3.784 0 01.964-2.755 3.468 3.468 0 012.6-.991 3.141 3.141 0 012.444.964 3.824 3.824 0 01.878 2.673 3.761 3.761 0 01-.946 2.683 3.318 3.318 0 01-2.535 1.007zm.082-6.385a2.132 2.132 0 00-1.709.735 3.017 3.017 0 00-.629 2.026 2.855 2.855 0 00.636 1.962 2.161 2.161 0 001.7.718 2.049 2.049 0 001.671-.7 3.048 3.048 0 00.585-2 3.1 3.1 0 00-.585-2.023 2.039 2.039 0 00-1.669-.718zM784.5 60.9l-2.1 7h-1.162l-1.442-5.011a3.293 3.293 0 01-.109-.649h-.027a3.066 3.066 0 01-.144.636l-1.569 5.024h-1.121l-2.119-7h1.176l1.449 5.264a3.167 3.167 0 01.1.629h.055a2.942 2.942 0 01.123-.643l1.613-5.25h1.025l1.449 5.277a3.8 3.8 0 01.1.629h.055a2.886 2.886 0 01.116-.629l1.422-5.277zM791.353 64.683h-4.943a2.618 2.618 0 00.629 1.8 2.168 2.168 0 001.654.636 3.441 3.441 0 002.174-.779v1.06a4.065 4.065 0 01-2.44.67 2.956 2.956 0 01-2.331-.954 3.9 3.9 0 01-.848-2.683 3.828 3.828 0 01.927-2.663 2.969 2.969 0 012.3-1.028 2.632 2.632 0 012.126.889 3.707 3.707 0 01.752 2.468zm-1.148-.95a2.276 2.276 0 00-.469-1.511 1.6 1.6 0 00-1.281-.54 1.808 1.808 0 00-1.347.567 2.58 2.58 0 00-.684 1.483zM796.7 62.037a1.372 1.372 0 00-.848-.226 1.429 1.429 0 00-1.2.677 3.122 3.122 0 00-.482 1.846V67.9h-1.121v-7h1.121v1.442h.027a2.447 2.447 0 01.731-1.152 1.668 1.668 0 011.1-.413 1.841 1.841 0 01.67.1zM801.9 67.9v-9.8h2.789a3.053 3.053 0 012.017.622 2.012 2.012 0 01.745 1.62 2.385 2.385 0 01-.451 1.449 2.432 2.432 0 01-1.244.875v.027a2.49 2.49 0 011.586.749 2.3 2.3 0 01.595 1.644 2.562 2.562 0 01-.9 2.037 3.358 3.358 0 01-2.276.779zm1.148-8.764V62.3h1.176a2.23 2.23 0 001.483-.455 1.584 1.584 0 00.54-1.281q0-1.43-1.88-1.429zm0 4.2v3.527h1.559a2.335 2.335 0 001.569-.479 1.641 1.641 0 00.557-1.312q0-1.736-2.365-1.736zM811.074 67.9h-1.148v-9.8h1.148z" fill="#5b5b5b"/>
    <path d="M777.6 35.017h-1.09v-2.18h1.09a4.2 4.2 0 004.195-4.195V6.375a4.2 4.2 0 00-4.195-4.2h-41.3a4.2 4.2 0 00-4.195 4.2v22.269a4.2 4.2 0 004.195 4.195h1.09v2.18h-1.09a6.382 6.382 0 01-6.374-6.375V6.375A6.382 6.382 0 01736.3 0h41.3a6.382 6.382 0 016.375 6.375v22.269a6.382 6.382 0 01-6.375 6.375"/>
    <path d="M743 27.719a2.958 2.958 0 012.958 2.958V37.5A2.958 2.958 0 01743 40.457a2.958 2.958 0 01-2.959-2.957v-6.822a2.958 2.958 0 012.958-2.958zM752.3 40.457a2.959 2.959 0 01-2.959-2.958V19.99a2.959 2.959 0 115.917 0V37.5a2.959 2.959 0 01-2.958 2.959M770.907 40.371a2.959 2.959 0 01-2.959-2.958v-24.8a2.959 2.959 0 015.917 0v24.8a2.959 2.959 0 01-2.958 2.959M761.6 40.457a2.959 2.959 0 01-2.959-2.958V24.492a2.959 2.959 0 115.917 0V37.5a2.959 2.959 0 01-2.958 2.959"/>
    <path d="M74.766 33.889H63.858c1.311 4.627-.45 5.291-8.163 5.291v2.42h26.228v-2.42c-7.713 0-8.469-.661-7.157-5.291" fill="#7a7a7a"/>
    <path d="M86.442 4.579h-35.51a2.269 2.269 0 00-2.18 2.284v24.763a2.256 2.256 0 002.18 2.265h35.51a2.479 2.479 0 002.424-2.265V6.863a2.488 2.488 0 00-2.424-2.284" fill="#a0a1a2"/>
    <path d="M86.467 4.582H50.931a2.268 2.268 0 00-2.18 2.284v24.76a2.256 2.256 0 002.18 2.266h.845z" fill="#fff" opacity=".2"/>
    <path fill="#59b4d9" d="M85.734 7.667v23.137H51.792V7.667h33.942z"/>
    <path fill="#59b4d9" d="M51.792 30.804h.047V7.667l31.031-.046h.002l-31.08.046v23.137z"/>
    <path fill="#a0a1a2" d="M55.695 39.179h26.227v2.424H55.695z"/>
    <path d="M69.224 6.26a.569.569 0 11-.57-.57.57.57 0 01.57.57" fill="#b8d432"/>
    <path d="M69.246 18.534a.223.223 0 01-.108-.03l-7.063-4.077a.217.217 0 01-.106-.185.214.214 0 01.106-.185l7.025-4.051a.215.215 0 01.211 0l7.065 4.079a.215.215 0 010 .369L69.355 18.5a.216.216 0 01-.108.03" fill="#fff"/>
    <path d="M68.231 28.443a.2.2 0 01-.108-.029l-7.041-4.064a.209.209 0 01-.109-.185v-8.156a.217.217 0 01.324-.185l7.041 4.063a.224.224 0 01.1.187v8.156a.218.218 0 01-.1.185.225.225 0 01-.107.029" fill="#fff" opacity=".7"/>
    <path d="M70.225 28.443a.23.23 0 01-.111-.029.217.217 0 01-.1-.185v-8.1a.221.221 0 01.1-.185l7.041-4.063a.209.209 0 01.212 0 .211.211 0 01.108.185v8.1a.21.21 0 01-.108.185l-7.039 4.064a.19.19 0 01-.1.029" fill="#fff" opacity=".4"/>
    <path d="M419.9 33.889h-10.91c1.311 4.627-.45 5.291-8.163 5.291v2.42h26.227v-2.42c-7.713 0-8.469-.661-7.157-5.291" fill="#7a7a7a"/>
    <path d="M431.574 4.579h-35.51a2.269 2.269 0 00-2.18 2.284v24.763a2.256 2.256 0 002.18 2.265h35.51A2.479 2.479 0 00434 31.626V6.863a2.488 2.488 0 00-2.424-2.284" fill="#a0a1a2"/>
    <path d="M431.6 4.582h-35.535a2.268 2.268 0 00-2.18 2.284v24.76a2.256 2.256 0 002.18 2.266h.845z" fill="#fff" opacity=".2"/>
    <path fill="#59b4d9" d="M430.866 7.667v23.137h-33.942V7.667h33.942z"/>
    <path fill="#59b4d9" d="M396.924 30.804h.046V7.667l31.032-.046h.001l-31.079.046v23.137z"/>
    <path fill="#a0a1a2" d="M400.827 39.179h26.227v2.424h-26.227z"/>
    <path d="M414.355 6.26a.569.569 0 11-.57-.57.57.57 0 01.57.57" fill="#b8d432"/>
    <path d="M414.378 18.534a.223.223 0 01-.108-.03l-7.063-4.077a.217.217 0 01-.106-.185.214.214 0 01.106-.185l7.021-4.051a.215.215 0 01.211 0l7.065 4.079a.215.215 0 010 .369l-7.018 4.05a.216.216 0 01-.108.03" fill="#fff"/>
    <path d="M413.363 28.443a.2.2 0 01-.108-.029l-7.042-4.064a.209.209 0 01-.109-.185v-8.156a.217.217 0 01.324-.185l7.041 4.063a.224.224 0 01.1.187v8.156a.218.218 0 01-.1.185.225.225 0 01-.107.029" fill="#fff" opacity=".7"/>
    <path d="M415.357 28.443a.23.23 0 01-.111-.029.217.217 0 01-.1-.185v-8.1a.221.221 0 01.1-.185l7.041-4.063a.209.209 0 01.212 0 .211.211 0 01.108.185v8.1a.21.21 0 01-.108.185l-7.039 4.064a.19.19 0 01-.1.029" fill="#fff" opacity=".4"/>
    <path d="M7.027 68.484H5.66l-1.64-2.748a5.9 5.9 0 00-.437-.652 2.471 2.471 0 00-.434-.441 1.523 1.523 0 00-.479-.25 1.992 1.992 0 00-.578-.078h-.944v4.17H0v-9.8h2.926a4.194 4.194 0 011.186.16 2.66 2.66 0 01.943.489 2.27 2.27 0 01.625.817 2.7 2.7 0 01.226 1.145 2.752 2.752 0 01-.154.939 2.46 2.46 0 01-.437.763 2.664 2.664 0 01-.684.571 3.5 3.5 0 01-.9.365v.027a2.022 2.022 0 01.427.25 2.305 2.305 0 01.345.331 4.375 4.375 0 01.325.435c.107.161.227.35.359.563zM1.148 59.72v3.555h1.559a2.355 2.355 0 00.8-.13 1.86 1.86 0 00.632-.372 1.7 1.7 0 00.417-.6 1.993 1.993 0 00.15-.789 1.536 1.536 0 00-.509-1.227 2.182 2.182 0 00-1.473-.441zM13.357 68.484h-1.148v-9.8h1.148zM15.935 68.484v-9.8h2.707q5.181 0 5.182 4.778a4.817 4.817 0 01-1.439 3.647 5.34 5.34 0 01-3.852 1.377zm1.148-8.764v7.725h1.463a4.151 4.151 0 003-1.032 3.87 3.87 0 001.073-2.926q0-3.766-4.006-3.767zM30.946 68.484h-5.2v-9.8h4.977v1.036H26.9v3.261h3.54v1.032H26.9v3.432h4.047zM39.443 68.648a3.249 3.249 0 01-2.478-.98 3.635 3.635 0 01-.926-2.6A3.786 3.786 0 0137 62.311a3.464 3.464 0 012.6-.991 3.14 3.14 0 012.444.964 3.824 3.824 0 01.878 2.673 3.761 3.761 0 01-.947 2.684 3.319 3.319 0 01-2.532 1.007zm.082-6.385a2.133 2.133 0 00-1.709.737 3.019 3.019 0 00-.629 2.027 2.853 2.853 0 00.636 1.962 2.161 2.161 0 001.7.718A2.049 2.049 0 0041.2 67a3.057 3.057 0 00.584-2 3.109 3.109 0 00-.584-2.023 2.039 2.039 0 00-1.675-.714zM50.531 68.484H49.41v-3.993q0-2.229-1.627-2.229a1.764 1.764 0 00-1.391.633 2.342 2.342 0 00-.55 1.6v3.992h-1.121v-7h1.121v1.162h.027a2.525 2.525 0 012.3-1.326 2.14 2.14 0 011.757.742 3.3 3.3 0 01.608 2.143zM56.629 68.484v-9.8h2.707q5.181 0 5.182 4.778a4.817 4.817 0 01-1.439 3.647 5.34 5.34 0 01-3.852 1.377zm1.148-8.764v7.725h1.463a4.151 4.151 0 003-1.032 3.87 3.87 0 001.073-2.926q0-3.766-4.006-3.767zM71.921 65.264h-4.942a2.616 2.616 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.053a4.058 4.058 0 01-2.44.67 2.961 2.961 0 01-2.331-.953 3.906 3.906 0 01-.848-2.684 3.824 3.824 0 01.926-2.662 2.969 2.969 0 012.3-1.029 2.634 2.634 0 012.126.889 3.706 3.706 0 01.752 2.468zm-1.148-.95A2.285 2.285 0 0070.3 62.8a1.594 1.594 0 00-1.282-.54 1.812 1.812 0 00-1.347.567 2.571 2.571 0 00-.684 1.483zM74.765 67.472h-.027V71.7h-1.122V61.484h1.121v1.23h.027a2.651 2.651 0 012.42-1.395 2.565 2.565 0 012.112.939 3.9 3.9 0 01.759 2.52 4.336 4.336 0 01-.854 2.813 2.843 2.843 0 01-2.338 1.057 2.343 2.343 0 01-2.098-1.176zm-.027-2.823v.978A2.08 2.08 0 0075.3 67.1a2.011 2.011 0 003.028-.174 3.575 3.575 0 00.578-2.167 2.824 2.824 0 00-.54-1.832 1.787 1.787 0 00-1.463-.663 1.987 1.987 0 00-1.572.68 2.5 2.5 0 00-.594 1.705zM82.968 68.484h-1.121V58.12h1.121zM88.163 68.648a3.249 3.249 0 01-2.478-.98 3.635 3.635 0 01-.926-2.6 3.786 3.786 0 01.964-2.755 3.464 3.464 0 012.6-.991 3.14 3.14 0 012.444.964 3.824 3.824 0 01.878 2.673 3.761 3.761 0 01-.945 2.681 3.319 3.319 0 01-2.537 1.008zm.082-6.385a2.133 2.133 0 00-1.709.737 3.019 3.019 0 00-.629 2.027 2.853 2.853 0 00.636 1.962 2.161 2.161 0 001.7.718 2.049 2.049 0 001.671-.7 3.057 3.057 0 00.584-2 3.109 3.109 0 00-.584-2.023 2.039 2.039 0 00-1.669-.721zM99.012 61.484l-3.22 8.116q-.861 2.174-2.42 2.174a2.551 2.551 0 01-.731-.089v-1a2.076 2.076 0 00.663.123 1.375 1.375 0 001.271-1.008l.561-1.326-2.736-6.99h1.244l1.894 5.387q.034.1.144.533h.041c.022-.109.068-.283.137-.52l1.989-5.4zM105.772 65.264h-4.942a2.616 2.616 0 00.629 1.8 2.167 2.167 0 001.654.636 3.441 3.441 0 002.174-.779v1.053a4.058 4.058 0 01-2.44.67 2.961 2.961 0 01-2.331-.953 3.906 3.906 0 01-.848-2.684 3.824 3.824 0 01.926-2.662 2.969 2.969 0 012.3-1.029 2.634 2.634 0 012.126.889 3.706 3.706 0 01.752 2.468zm-1.148-.95a2.285 2.285 0 00-.468-1.511 1.594 1.594 0 00-1.282-.54 1.812 1.812 0 00-1.347.567 2.571 2.571 0 00-.684 1.483zM113.442 68.484h-1.121v-1.19h-.027a2.588 2.588 0 01-2.406 1.354 2.616 2.616 0 01-2.109-.939 3.858 3.858 0 01-.79-2.561 4.193 4.193 0 01.875-2.782 2.885 2.885 0 012.336-1.046 2.245 2.245 0 012.1 1.135h.027V58.12h1.121zm-1.121-3.165v-1.033a2.005 2.005 0 00-.561-1.436 1.878 1.878 0 00-1.422-.588 1.934 1.934 0 00-1.613.752 3.294 3.294 0 00-.588 2.078A2.961 2.961 0 00108.7 67a1.841 1.841 0 001.514.7 1.915 1.915 0 001.521-.677 2.521 2.521 0 00.586-1.704zM126.984 58.681l-3.63 9.8h-1.264l-3.555-9.8h1.278l2.714 7.772a4.659 4.659 0 01.2.868h.027a4.217 4.217 0 01.226-.882l2.769-7.759zM138.387 68.484h-1.142v-6.577q0-.779.1-1.907h-.027a6.1 6.1 0 01-.294.95l-3.35 7.533h-.561l-3.343-7.479a5.844 5.844 0 01-.294-1h-.027q.054.587.055 1.921v6.563h-1.107v-9.8h1.518l3.008 6.836a8.719 8.719 0 01.451 1.176h.041c.2-.537.353-.939.472-1.2l3.069-6.809h1.436z" fill="#5b5b5b"/>
</svg>

## Overview

When a business launches a marketing campaign to interest customers in new or existing product(s), they often use a set of business rules to select leads for their campaign to target. Machine learning can be used to help increase the response rate from these leads. This solution demonstrates how to use a model to predict actions that are expected to maximize the purchase rate of leads targeted by the campaign. These predictions serve as the basis for recommendations to be used by a renewed campaign on how to contact (for example, e-mail, SMS, or cold call) and when to contact (day of week and time of day) the targeted leads. The solution presented here uses simulated data from the insurance industry to model responses of the leads to the campaign. The model predictors include demographic details of the leads, historical campaign performance, and product-specific details. The model predicts the probability that each lead in the database makes a purchase from a channel, on each day of the week at various times of day. Recommendations on which channel, day of week and time of day to use when targeting users are based then on the channel and timing combination that the model predicts will have the highest probability a purchase being made.

The Microsoft Marketing Campaign Optimization solution is a combination of a Machine learning prediction model and an interactive visualization tool, PowerBI. The solution is used to increase the response rate to a campaign by recommending the channel to contact (for example, e-mail, SMS, or cold call) as well as when to contact (day of week and time of day) targeted leads for use in a new campaign. The solution uses simulated data, which can easily be configured to use your own organizationâ€™s data, to model the acquisition campaign response. The model uses predictors such as demographics, historical campaign performance and product details. The solution predicts the probability of a lead conversion from each channel, at various times of the day and days of the week, for every lead in the database. The final recommendation for targeting each lead is decided based upon the combination of channel, day of week and time of day with the highest probability of conversion. The solution has been modeled after a standardized data science process, where the data preparation, model training and evaluation can be easily done by a data scientist and the insights visualized and correlated to KPIs by marketing via Power BI visualization.

## Business Manager Perspective

This solution template uses (simulated) historical data to predict how and when to contact leads for your campaign. The recommendations include the best channel to contact a lead (in our example, email, SMS, or cold call), the best day of the week and the best time of day in which to make the contact.

SQL Server R Services brings the compute to the data by allowing R to run on the same computer as the database. It includes a database service that runs outside the SQL Server process and communicates securely with the R runtime.

This solution packet shows how to create and refine data, train R models, and perform predictions on the SQL Server machine. The final predictions table in SQL Server provides recommendations for how and when to contact each lead. This data is then visualized in Power BI.

Power BI also presents visual summaries of the effectiveness of the campaign recommendations (shown here with simulated data). You can try out this dashboard by clicking the Try it Now link.

The Recommendations tab of this dashboard shows the predicted recommendations. At the top is a table of individual leads for our new deployment. This includes fields for the lead ID, campaign and product, populated with leads on which our business rules are to be applied. This is followed by the model predictions for the leads, giving the optimal channel and time to contact each one, and then the estimated probabilities that the leads will buy our product using these recommendations. These probabilities can be used to increase the efficiency of the campaign by limiting the number of leads contacted to the subset most likely to buy.

Also on the Recommendations tab are various summaries of recommendations and demographic information on the leads.

The Campaign Summary tab of the dashboard shows summaries of the historical data used to create the predicted recommendations. While this tab also shows values of Day of Week, Time of Day, and Channel, these values are actual past observations, not to be confused with the recommendations shown on the Recommendations tab.

## Data Scientist Perspective

SQL Server R Services brings the compute to the data by running R on the computer that hosts the database. It includes a database service that runs outside the SQL Server process and communicates securely with the R runtime.

This solution walks through the steps to create and refine data, train R models, and perform scoring on the SQL Server machine. The final scored database table in SQL Server gives the recommendations for how and when to contact each lead. This data is then visualized in PowerBI, which also contains a summary of the success of the recommendations used in your new campaign after it has completed. (Simulated data is shown in this template to illustrate the feature.)

Data scientists who are testing and developing solutions can work from the convenience of their R IDE on their client machine, while [pushing the compute to the SQL Server machine](/sql/advanced-analytics/r/getting-started-with-sql-server-r-services/). The completed solutions are deployed to SQL Server 2016 by embedding calls to R in stored procedures. These solutions can then be further automated with SQL Server Integration Services and SQL Server agent.

Click on the Deploy button to test the automation and the entire solution will be made available in your Azure subscription.

## Pricing

Your Azure subscription used for the deployment will incur consumption charges on the services used in this solution, approximately $1.15/hour for the default VM.

Please ensure that you stop your VM instance when not actively using the solution. Running the VM will incur higher costs.

Please delete the solution if you are not using it.

[!INCLUDE [js_include_file](../../_js/index.md)]
